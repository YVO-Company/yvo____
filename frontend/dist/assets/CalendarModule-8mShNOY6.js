import{t as e}from"./check-BjCImq_k.js";import{t}from"./chevron-left-BGwdk1J0.js";import{t as n}from"./chevron-right-CMb6ihDi.js";import{t as r}from"./plus-CEMkcid2.js";import{t as i}from"./trash-2-Eo-Zwxxt.js";import{i as a,n as o,r as s,w as c,y as l}from"./index-FG9feFxU.js";var u=c(l(),1),d=s();function f(){let[s,c]=(0,u.useState)(new Date),[l,f]=(0,u.useState)([]),[p,m]=(0,u.useState)(!0),[h,g]=(0,u.useState)(!1),[_,v]=(0,u.useState)(!1),[y,b]=(0,u.useState)(null),[x,S]=(0,u.useState)({title:``,description:``,start:``,end:``,type:`Meeting`,visibility:`public`,targetCategories:[]}),C=[`General`,`Sales`,`Dev`,`Management`];(0,u.useEffect)(()=>{w()},[s]);let w=async()=>{try{let e=localStorage.getItem(`companyId`),t=new Date(s.getFullYear(),s.getMonth(),1),n=new Date(s.getFullYear(),s.getMonth()+1,0);f((await o.get(`/calendar`,{params:{companyId:e,start:t.toISOString(),end:n.toISOString()}})).data)}catch(e){console.error(`Failed to fetch events`,e)}finally{m(!1)}},T=()=>{S({title:``,description:``,start:``,end:``,type:`Meeting`,visibility:`public`,targetCategories:[]}),v(!1),b(null)},E=e=>{if(T(),e){let t=new Date(e),n=new Date(t.setHours(9,0,0)).toISOString().slice(0,16),r=new Date(t.setHours(10,0,0)).toISOString().slice(0,16);S({...x,start:n,end:r})}else{let e=new Date,t=new Date(e.setMinutes(0,0,0)).toISOString().slice(0,16),n=new Date(e.getTime()+3600*1e3).toISOString().slice(0,16);S({...x,start:t,end:n})}g(!0)},D=e=>{S({title:e.title,description:e.description||``,start:e.start.slice(0,16),end:e.end.slice(0,16),type:e.type,visibility:e.visibility||`public`,targetCategories:e.targetCategories||[]}),v(!0),b(e._id),g(!0)},O=async e=>{e.preventDefault();try{let e=localStorage.getItem(`companyId`),t={...x,companyId:e};_?await o.put(`/calendar/${y}`,t):await o.post(`/calendar`,t),g(!1),T(),w()}catch(e){console.error(e),alert(`Failed to save event`)}},k=async()=>{if(window.confirm(`Are you sure you want to delete this event?`))try{await o.delete(`/calendar/${y}`),g(!1),T(),w()}catch(e){console.error(e),alert(`Failed to delete event`)}},A=e=>{S(t=>{let n=t.targetCategories.includes(e)?t.targetCategories.filter(t=>t!==e):[...t.targetCategories,e];return{...t,targetCategories:n}})},j=()=>{let e=s.getFullYear(),t=s.getMonth();return new Date(e,t+1,0).getDate()},M=()=>new Date(s.getFullYear(),s.getMonth(),1).getDay(),N=()=>{let e=j(),t=M(),n=[];for(let e=0;e<t;e++)n.push((0,d.jsx)(`div`,{className:`h-32 bg-slate-50/50 border-b border-r border-slate-100`},`empty-${e}`));for(let t=1;t<=e;t++){let e=new Date(s.getFullYear(),s.getMonth(),t),i=e.toDateString(),a=l.filter(e=>new Date(e.start).toDateString()===i);n.push((0,d.jsxs)(`div`,{className:`h-32 bg-white border-b border-r border-slate-100 p-2 hover:bg-slate-50 transition relative group`,children:[(0,d.jsx)(`span`,{className:`text-sm font-medium ${new Date().toDateString()===i?`bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center`:`text-slate-700`}`,children:t}),(0,d.jsx)(`div`,{className:`mt-1 space-y-1 overflow-y-auto max-h-20 custom-scrollbar`,children:a.map(e=>(0,d.jsx)(`button`,{onClick:t=>{t.stopPropagation(),D(e)},className:`w-full text-left text-xs p-1 rounded border overflow-hidden truncate transition-all hover:scale-[1.02] ${e.type===`Meeting`?`bg-blue-100 text-blue-800 border-blue-200`:e.type===`Task`?`bg-green-100 text-green-800 border-green-200`:`bg-amber-100 text-amber-800 border-amber-200`}`,children:e.title},e._id))}),(0,d.jsx)(`button`,{onClick:()=>E(e),className:`absolute bottom-2 right-2 opacity-0 group-hover:opacity-100 bg-indigo-50 text-indigo-600 rounded p-1 hover:bg-indigo-100 transition shadow-sm`,children:(0,d.jsx)(r,{size:14})})]},t))}return n},P=e=>{c(new Date(s.getFullYear(),s.getMonth()+e,1))};return(0,d.jsxs)(`div`,{className:`h-full flex flex-col space-y-4`,children:[(0,d.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,d.jsxs)(`div`,{children:[(0,d.jsx)(`h1`,{className:`text-2xl font-bold text-slate-800`,children:`Calendar & Reminders`}),(0,d.jsx)(`p`,{className:`text-sm text-slate-500`,children:`Schedule meetings, tasks, and deadlines.`})]}),(0,d.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,d.jsxs)(`div`,{className:`flex items-center bg-white border border-slate-200 rounded-lg p-1 shadow-sm`,children:[(0,d.jsx)(`button`,{onClick:()=>P(-1),className:`p-1 hover:bg-slate-100 rounded`,children:(0,d.jsx)(t,{size:20})}),(0,d.jsx)(`span`,{className:`w-32 text-center font-semibold text-slate-700`,children:s.toLocaleString(`default`,{month:`long`,year:`numeric`})}),(0,d.jsx)(`button`,{onClick:()=>P(1),className:`p-1 hover:bg-slate-100 rounded`,children:(0,d.jsx)(n,{size:20})})]}),(0,d.jsxs)(`button`,{onClick:()=>E(),className:`flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 shadow-sm transition-all active:scale-95`,children:[(0,d.jsx)(r,{size:18}),` New Event`]})]})]}),(0,d.jsxs)(`div`,{className:`flex-grow bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden flex flex-col`,children:[(0,d.jsx)(`div`,{className:`grid grid-cols-7 border-b border-slate-200 bg-slate-50`,children:[`Sun`,`Mon`,`Tue`,`Wed`,`Thu`,`Fri`,`Sat`].map(e=>(0,d.jsx)(`div`,{className:`py-2 text-center text-xs font-semibold text-slate-500 uppercase tracking-wide`,children:e},e))}),(0,d.jsx)(`div`,{className:`grid grid-cols-7 flex-grow overflow-auto`,children:N()})]}),h&&(0,d.jsx)(`div`,{className:`fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4`,children:(0,d.jsxs)(`div`,{className:`bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200`,children:[(0,d.jsxs)(`div`,{className:`flex justify-between items-center p-4 border-b border-slate-100 bg-slate-50/50`,children:[(0,d.jsx)(`h2`,{className:`text-xl font-bold text-slate-800`,children:_?`Edit Event`:`New Event`}),(0,d.jsx)(`button`,{onClick:()=>g(!1),className:`text-slate-400 hover:text-slate-600`,children:(0,d.jsx)(a,{size:20})})]}),(0,d.jsxs)(`form`,{onSubmit:O,className:`p-6 space-y-4`,children:[(0,d.jsx)(`input`,{required:!0,placeholder:`Event Title`,className:`w-full border border-slate-200 p-2.5 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`,value:x.title,onChange:e=>S({...x,title:e.target.value})}),(0,d.jsx)(`textarea`,{placeholder:`Description (Optional)`,className:`w-full border border-slate-200 p-2.5 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none h-24 resize-none`,value:x.description,onChange:e=>S({...x,description:e.target.value})}),(0,d.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,d.jsxs)(`div`,{children:[(0,d.jsx)(`label`,{className:`text-xs font-semibold text-slate-500 mb-1 block`,children:`Start`}),(0,d.jsx)(`input`,{required:!0,type:`datetime-local`,className:`w-full border border-slate-200 p-2 rounded-lg`,value:x.start,onChange:e=>S({...x,start:e.target.value})})]}),(0,d.jsxs)(`div`,{children:[(0,d.jsx)(`label`,{className:`text-xs font-semibold text-slate-500 mb-1 block`,children:`End`}),(0,d.jsx)(`input`,{required:!0,type:`datetime-local`,className:`w-full border border-slate-200 p-2 rounded-lg`,value:x.end,onChange:e=>S({...x,end:e.target.value})})]})]}),(0,d.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,d.jsxs)(`div`,{children:[(0,d.jsx)(`label`,{className:`text-xs font-semibold text-slate-500 mb-1 block`,children:`Type`}),(0,d.jsxs)(`select`,{className:`w-full border border-slate-200 p-2 rounded-lg bg-white`,value:x.type,onChange:e=>S({...x,type:e.target.value}),children:[(0,d.jsx)(`option`,{value:`Meeting`,children:`Meeting`}),(0,d.jsx)(`option`,{value:`Task`,children:`Task`}),(0,d.jsx)(`option`,{value:`Reminder`,children:`Reminder`})]})]}),(0,d.jsxs)(`div`,{children:[(0,d.jsx)(`label`,{className:`text-xs font-semibold text-slate-500 mb-1 block`,children:`Visibility`}),(0,d.jsxs)(`select`,{className:`w-full border border-slate-200 p-2 rounded-lg bg-white`,value:x.visibility,onChange:e=>S({...x,visibility:e.target.value}),children:[(0,d.jsx)(`option`,{value:`public`,children:`All Employees`}),(0,d.jsx)(`option`,{value:`category`,children:`Specific Teams`})]})]})]}),x.visibility===`category`&&(0,d.jsxs)(`div`,{className:`bg-slate-50 p-3 rounded-lg border border-slate-100`,children:[(0,d.jsx)(`label`,{className:`text-xs font-semibold text-slate-500 mb-2 block`,children:`Select Teams`}),(0,d.jsx)(`div`,{className:`flex flex-wrap gap-2`,children:C.map(t=>(0,d.jsxs)(`button`,{type:`button`,onClick:()=>A(t),className:`px-3 py-1 rounded-full text-xs font-medium border transition-colors ${x.targetCategories.includes(t)?`bg-indigo-100 text-indigo-700 border-indigo-200`:`bg-white text-slate-600 border-slate-200 hover:border-indigo-300`}`,children:[x.targetCategories.includes(t)&&(0,d.jsx)(e,{size:12,className:`inline mr-1`}),t]},t))}),x.targetCategories.length===0&&(0,d.jsx)(`p`,{className:`text-xs text-red-500 mt-2`,children:`Please select at least one team.`})]}),(0,d.jsxs)(`div`,{className:`flex justify-between items-center pt-4 border-t border-slate-100 mt-4`,children:[_?(0,d.jsxs)(`button`,{type:`button`,onClick:k,className:`flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium text-sm`,children:[(0,d.jsx)(i,{size:16}),` Delete`]}):(0,d.jsx)(`div`,{}),(0,d.jsxs)(`div`,{className:`flex gap-2`,children:[(0,d.jsx)(`button`,{type:`button`,onClick:()=>g(!1),className:`px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg font-medium text-sm`,children:`Cancel`}),(0,d.jsx)(`button`,{type:`submit`,className:`px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium text-sm shadow-sm transition-all active:scale-95`,children:_?`Update Event`:`Add Event`})]})]})]})]})})]})}export{f as default};