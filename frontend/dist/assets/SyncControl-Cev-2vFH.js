import{t as e}from"./circle-check-big-D3q_FoYY.js";import{t}from"./clock-p49MgRWf.js";import{t as n}from"./database-BRdzMIiP.js";import{t as r}from"./triangle-alert-CVdzsyTG.js";import{c as i,n as a,r as o,u as s,w as c,y as l}from"./index-FG9feFxU.js";var u=i(`rotate-cw`,[[`path`,{d:`M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8`,key:`1p45f6`}],[`path`,{d:`M21 3v5h-5`,key:`1q7to0`}]]),d=i(`server`,[[`rect`,{width:`20`,height:`8`,x:`2`,y:`2`,rx:`2`,ry:`2`,key:`ngkwjq`}],[`rect`,{width:`20`,height:`8`,x:`2`,y:`14`,rx:`2`,ry:`2`,key:`iecqi9`}],[`line`,{x1:`6`,x2:`6.01`,y1:`6`,y2:`6`,key:`16zg32`}],[`line`,{x1:`6`,x2:`6.01`,y1:`18`,y2:`18`,key:`nzw8ys`}]]),f=c(l(),1),p=o();function m(){let[i,o]=(0,f.useState)(!0),[c,l]=(0,f.useState)({storage:{usedGB:0,limitTB:10,percent:0},syncHealth:{active:0,total:0},settings:{mandatoryCloudBackup:!0,autoYearlyArchive:!1}}),[m,h]=(0,f.useState)([]),[g,_]=(0,f.useState)(!1);(0,f.useEffect)(()=>{v();let e=setInterval(v,3e4);return()=>clearInterval(e)},[]);let v=async()=>{try{let[e,t]=await Promise.all([a.get(`/sa/sync/stats`),a.get(`/sa/sync/logs`)]);l(e.data),h(t.data),o(!1)}catch(e){console.error(`Failed to load sync data`,e),s.error(`Failed to load system status`),o(!1)}},y=async()=>{_(!0);try{await a.post(`/sa/sync/manual-backup`),s.success(`System backup triggered successfully!`),setTimeout(v,2e3)}catch{s.error(`Backup trigger failed`)}finally{_(!1)}},b=async e=>{let t={...c.settings,[e]:!c.settings[e]};l(e=>({...e,settings:t}));try{await a.patch(`/sa/sync/config`,t),s.success(`Configuration updated`)}catch{s.error(`Failed to update settings`),l(n=>({...n,settings:{...n.settings,[e]:!t[e]}}))}};return i?(0,p.jsx)(`div`,{className:`p-10 text-center animate-pulse text-slate-500`,children:`Loading Cloud Status...`}):(0,p.jsxs)(`div`,{className:`space-y-6 max-w-7xl mx-auto`,children:[(0,p.jsxs)(`div`,{className:`flex justify-between items-end`,children:[(0,p.jsxs)(`div`,{children:[(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-slate-800`,children:`Cloud & Sync Control`}),(0,p.jsx)(`p`,{className:`text-sm text-slate-500 mt-1`,children:`Monitor global synchronization status, storage limits, and backups.`})]}),(0,p.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-slate-500 bg-slate-50 px-3 py-1 rounded-full border border-slate-200`,children:[(0,p.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-emerald-500 animate-pulse`}),`System Operational`]})]}),(0,p.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-2 gap-8`,children:[(0,p.jsxs)(`div`,{className:`space-y-8`,children:[(0,p.jsxs)(`div`,{className:`bg-white rounded-xl border border-slate-200 shadow-sm p-6 relative overflow-hidden`,children:[(0,p.jsxs)(`div`,{className:`flex justify-between items-start mb-6`,children:[(0,p.jsxs)(`div`,{children:[(0,p.jsxs)(`h3`,{className:`font-semibold text-slate-800 flex items-center gap-2`,children:[(0,p.jsx)(n,{size:18,className:`text-blue-600`}),`Global Data Usage`]}),(0,p.jsx)(`p`,{className:`text-xs text-slate-500 mt-1`,children:`Total database and file storage across all tenants.`})]}),(0,p.jsxs)(`div`,{className:`text-right`,children:[(0,p.jsxs)(`div`,{className:`text-2xl font-bold text-slate-900`,children:[c.storage.usedGB,` `,(0,p.jsx)(`span`,{className:`text-sm font-normal text-slate-500`,children:`GB`})]}),(0,p.jsxs)(`div`,{className:`text-xs text-slate-400`,children:[`of `,c.storage.limitTB,` TB Allocated`]})]})]}),(0,p.jsx)(`div`,{className:`w-full bg-slate-100 rounded-full h-3 mb-2 overflow-hidden`,children:(0,p.jsx)(`div`,{className:`h-3 rounded-full transition-all duration-1000 ${Number(c.storage.percent)>80?`bg-red-500`:`bg-blue-600`}`,style:{width:`${Math.max(Number(c.storage.percent),1)}%`}})}),(0,p.jsxs)(`div`,{className:`flex justify-between text-xs font-medium text-slate-600`,children:[(0,p.jsx)(`span`,{children:`0 GB`}),(0,p.jsxs)(`span`,{children:[c.storage.percent,`% Used`]}),(0,p.jsxs)(`span`,{children:[c.storage.limitTB*1024,` GB`]})]})]}),(0,p.jsxs)(`div`,{className:`bg-white rounded-xl border border-slate-200 shadow-sm p-6`,children:[(0,p.jsxs)(`h3`,{className:`font-semibold text-slate-800 mb-6 flex items-center gap-2`,children:[(0,p.jsx)(d,{size:18,className:`text-slate-600`}),`System Policies`]}),(0,p.jsxs)(`div`,{className:`flex items-center justify-between py-4 border-b border-slate-100`,children:[(0,p.jsxs)(`div`,{children:[(0,p.jsx)(`div`,{className:`font-medium text-slate-900`,children:`Mandatory Cloud Backup`}),(0,p.jsx)(`div`,{className:`text-xs text-slate-500`,children:`Enforce daily cloud backups for all companies`})]}),(0,p.jsx)(`button`,{onClick:()=>b(`mandatoryCloudBackup`),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${c.settings.mandatoryCloudBackup?`bg-blue-600`:`bg-slate-300`}`,children:(0,p.jsx)(`span`,{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c.settings.mandatoryCloudBackup?`translate-x-6`:`translate-x-1`}`})})]}),(0,p.jsxs)(`div`,{className:`flex items-center justify-between py-4`,children:[(0,p.jsxs)(`div`,{children:[(0,p.jsx)(`div`,{className:`font-medium text-slate-900`,children:`Auto Yearly Archive`}),(0,p.jsx)(`div`,{className:`text-xs text-slate-500`,children:`Archive inactive data annually to cold storage`})]}),(0,p.jsx)(`button`,{onClick:()=>b(`autoYearlyArchive`),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${c.settings.autoYearlyArchive?`bg-blue-600`:`bg-slate-300`}`,children:(0,p.jsx)(`span`,{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c.settings.autoYearlyArchive?`translate-x-6`:`translate-x-1`}`})})]})]}),(0,p.jsxs)(`div`,{className:`bg-gradient-to-br from-indigo-50 to-white rounded-xl border border-indigo-100 p-6`,children:[(0,p.jsx)(`h3`,{className:`font-semibold text-indigo-900 mb-2`,children:`System Backup & Sync`}),(0,p.jsx)(`p`,{className:`text-sm text-indigo-700/80 mb-4`,children:`Trigger an immediate system-wide backup and status check.`}),(0,p.jsxs)(`button`,{onClick:y,disabled:g,className:`w-full py-3 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-70 disabled:cursor-not-allowed text-white font-semibold rounded-lg shadow-sm transition-all flex items-center justify-center gap-2`,children:[(0,p.jsx)(u,{size:18,className:g?`animate-spin`:``}),g?`Backing Up System...`:`Trigger System Backup`]})]})]}),(0,p.jsxs)(`div`,{className:`space-y-6`,children:[(0,p.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,p.jsxs)(`div`,{className:`bg-emerald-50 border border-emerald-100 p-4 rounded-xl`,children:[(0,p.jsx)(`div`,{className:`text-emerald-800 text-xs font-bold uppercase tracking-wider mb-1`,children:`Active Sync`}),(0,p.jsx)(`div`,{className:`text-2xl font-bold text-emerald-900`,children:c.syncHealth.active}),(0,p.jsx)(`div`,{className:`text-xs text-emerald-600 mt-1`,children:`Companies Online (24h)`})]}),(0,p.jsxs)(`div`,{className:`bg-slate-50 border border-slate-100 p-4 rounded-xl`,children:[(0,p.jsx)(`div`,{className:`text-slate-500 text-xs font-bold uppercase tracking-wider mb-1`,children:`Total Companies`}),(0,p.jsx)(`div`,{className:`text-2xl font-bold text-slate-700`,children:c.syncHealth.total}),(0,p.jsx)(`div`,{className:`text-xs text-slate-400 mt-1`,children:`Registered Tenants`})]})]}),(0,p.jsxs)(`div`,{className:`bg-white rounded-xl border border-slate-200 shadow-sm p-6 h-[500px] flex flex-col`,children:[(0,p.jsxs)(`h3`,{className:`font-semibold text-slate-800 mb-6 flex items-center gap-2`,children:[(0,p.jsx)(t,{size:18,className:`text-slate-400`}),`System Audit & Sync Logs`]}),(0,p.jsx)(`div`,{className:`overflow-y-auto pr-2 space-y-6 custom-scrollbar flex-1`,children:m.length>0?m.map((t,n)=>(0,p.jsxs)(`div`,{className:`relative flex gap-4 group`,children:[n!==m.length-1&&(0,p.jsx)(`div`,{className:`absolute left-[11px] top-8 bottom-[-24px] w-px bg-slate-200`}),(0,p.jsx)(`div`,{className:`relative z-10 flex-shrink-0 mt-1`,children:t.action?.includes(`ERROR`)||t.action?.includes(`FAIL`)?(0,p.jsx)(`div`,{className:`w-6 h-6 rounded-full bg-red-100 flex items-center justify-center border border-white shadow-sm`,children:(0,p.jsx)(r,{size:12,className:`text-red-600`})}):(0,p.jsx)(`div`,{className:`w-6 h-6 rounded-full bg-emerald-100 flex items-center justify-center border border-white shadow-sm`,children:(0,p.jsx)(e,{size:12,className:`text-emerald-600`})})}),(0,p.jsxs)(`div`,{className:`flex-1 pb-1`,children:[(0,p.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,p.jsx)(`div`,{className:`text-sm font-medium text-slate-900`,children:t.action.replace(/_/g,` `)}),(0,p.jsx)(`div`,{className:`text-[10px] font-mono text-slate-400 whitespace-nowrap`,children:new Date(t.timestamp).toLocaleString()})]}),(0,p.jsxs)(`div`,{className:`text-xs text-slate-500 mt-0.5`,children:[t.actorId?.fullName||`System`,` â€¢ `,t.targetModel||`Global`]}),t.details&&(0,p.jsx)(`div`,{className:`mt-2 bg-slate-50 p-2 rounded border border-slate-100 text-[10px] font-mono text-slate-600`,children:JSON.stringify(t.details)})]})]},t._id||n)):(0,p.jsx)(`div`,{className:`text-center py-10 text-slate-400 text-sm`,children:`No recent logs found.`})})]})]})]})]})}export{m as default};