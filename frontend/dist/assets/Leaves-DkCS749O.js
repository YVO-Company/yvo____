import{t as e}from"./circle-check-big-D3q_FoYY.js";import{c as t,n,r,w as i,y as a}from"./index-FG9feFxU.js";var o=t(`circle-x`,[[`circle`,{cx:`12`,cy:`12`,r:`10`,key:`1mglay`}],[`path`,{d:`m15 9-6 6`,key:`1uzhvr`}],[`path`,{d:`m9 9 6 6`,key:`z0biqf`}]]),s=i(a(),1),c=r();function l(){let[t,r]=(0,s.useState)([]),[i,a]=(0,s.useState)(!0),[l,d]=(0,s.useState)(`Pending`);(0,s.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=localStorage.getItem(`companyId`),t=await n.get(`/employees/leaves`,{params:{companyId:e}});console.log(`Leaves API Response:`,t.data),Array.isArray(t.data)?r(t.data):(console.error(`Leaves API did not return an array:`,t.data),r([]))}catch(e){console.error(`Failed to fetch leaves:`,e),r([])}finally{a(!1)}},p=async(e,t,r)=>{let i=r||``;if(t===`Rejected`){let e=prompt(`Reason for rejection (optional):`);if(e===null)return;i=e}try{await n.patch(`/employees/leaves/${e}`,{status:t,remark:i}),f()}catch{alert(`Failed to update status`)}},m=l===`All`?t:t.filter(e=>e.status===l);return i?(0,c.jsx)(`div`,{className:`p-10 text-center`,children:`Loading Leave Requests...`}):(0,c.jsxs)(`div`,{className:`space-y-6`,children:[(0,c.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,c.jsxs)(`div`,{children:[(0,c.jsx)(`h1`,{className:`text-2xl font-bold text-slate-800`,children:`Leave Management`}),(0,c.jsx)(`p`,{className:`text-sm text-slate-500`,children:`Manage employee leave requests.`})]}),(0,c.jsx)(`div`,{className:`flex gap-2`,children:[`Pending`,`Approved`,`Rejected`,`All`].map(e=>(0,c.jsx)(`button`,{onClick:()=>d(e),className:`px-3 py-1.5 text-xs font-medium rounded-lg border transition ${l===e?`bg-indigo-600 text-white border-indigo-600`:`bg-white text-slate-600 border-slate-200 hover:bg-slate-50`}`,children:e},e))})]}),(0,c.jsx)(`div`,{className:`bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm`,children:(0,c.jsxs)(`table`,{className:`w-full text-left text-sm`,children:[(0,c.jsx)(`thead`,{className:`bg-slate-50 text-slate-500 font-medium border-b border-slate-200`,children:(0,c.jsxs)(`tr`,{children:[(0,c.jsx)(`th`,{className:`px-6 py-4`,children:`Employee`}),(0,c.jsx)(`th`,{className:`px-6 py-4`,children:`Type`}),(0,c.jsx)(`th`,{className:`px-6 py-4`,children:`Dates`}),(0,c.jsx)(`th`,{className:`px-6 py-4`,children:`Reason`}),(0,c.jsx)(`th`,{className:`px-6 py-4`,children:`Status`}),(0,c.jsx)(`th`,{className:`px-6 py-4 text-center`,children:`Action`})]})}),(0,c.jsxs)(`tbody`,{className:`divide-y divide-slate-100`,children:[m.length===0&&(0,c.jsx)(`tr`,{children:(0,c.jsx)(`td`,{colSpan:`6`,className:`px-6 py-8 text-center text-slate-500`,children:`No requests found.`})}),m.map(t=>(0,c.jsxs)(`tr`,{className:`hover:bg-slate-50`,children:[(0,c.jsx)(`td`,{className:`px-6 py-4 font-medium text-slate-900`,children:(0,c.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,c.jsxs)(`div`,{className:`w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs`,children:[t.employeeId?.firstName?.[0],t.employeeId?.lastName?.[0]]}),(0,c.jsxs)(`div`,{children:[(0,c.jsxs)(`div`,{className:`font-semibold`,children:[t.employeeId?.firstName,` `,t.employeeId?.lastName]}),(0,c.jsx)(`div`,{className:`text-xs text-slate-500`,children:t.employeeId?.position})]})]})}),(0,c.jsx)(`td`,{className:`px-6 py-4 text-slate-700`,children:t.type}),(0,c.jsx)(`td`,{className:`px-6 py-4 text-slate-600`,children:(0,c.jsxs)(`div`,{className:`flex flex-col text-xs`,children:[(0,c.jsxs)(`span`,{children:[`From: `,new Date(t.startDate).toLocaleDateString()]}),(0,c.jsxs)(`span`,{children:[`To: `,new Date(t.endDate).toLocaleDateString()]})]})}),(0,c.jsx)(`td`,{className:`px-6 py-4 text-slate-600 max-w-xs truncate`,title:t.reason,children:t.reason}),(0,c.jsx)(`td`,{className:`px-6 py-4`,children:(0,c.jsx)(u,{status:t.status})}),(0,c.jsxs)(`td`,{className:`px-6 py-4 text-center`,children:[t.status===`Pending`&&(0,c.jsxs)(`div`,{className:`flex justify-center gap-2`,children:[(0,c.jsx)(`button`,{onClick:()=>p(t._id,`Approved`),className:`p-1 text-green-600 hover:bg-green-50 rounded`,title:`Approve`,children:(0,c.jsx)(e,{size:18})}),(0,c.jsx)(`button`,{onClick:()=>p(t._id,`Rejected`),className:`p-1 text-red-600 hover:bg-red-50 rounded`,title:`Reject`,children:(0,c.jsx)(o,{size:18})})]}),t.status!==`Pending`&&(0,c.jsx)(`span`,{className:`text-xs text-slate-400`,children:`-`})]})]},t._id))]})]})})]})}var u=({status:e})=>{let t={Pending:`bg-amber-100 text-amber-800`,Approved:`bg-green-100 text-green-800`,Rejected:`bg-red-100 text-red-800`};return(0,c.jsx)(`span`,{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${t[e]||t.Pending}`,children:e})};export{l as default};